<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Snowmelt and Streamflow: The Role of Snow Water Equivalent in Shaping Discharge Patterns in the Cache la Poudre River</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>


<meta name="citation_title" content="Snowmelt and Streamflow: The Role of Snow Water Equivalent in Shaping Discharge Patterns in the Cache la Poudre River">
<meta name="citation_author" content="Maya McCain">
<meta name="citation_author" content="Emily Mitchell">
<meta name="citation_author" content="Ally Lewis">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=How does snow persistence relate to annual streamflow in mountain watersheds of the western US with wet maritime and dry continental climates?;,citation_author=John C Hammond;,citation_author=Freddy A Saavedra;,citation_author=Stephanie K Kampf;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=4;,citation_volume=54;,citation_journal_title=Water Resources Research;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Importance analysis of local and global climate inputs for basin-scale streamflow prediction;,citation_author=Rajib Maity;,citation_author=SS Kashid;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_issue=11;,citation_volume=47;,citation_journal_title=Water Resources Research;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Investigating the role of snow water equivalent on streamflow predictability during drought;,citation_author=Parthkumar A Modi;,citation_author=Eric E Small;,citation_author=Joseph Kasprzyk;,citation_author=Ben Livneh;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_issue=10;,citation_volume=23;,citation_journal_title=Journal of Hydrometeorology;">
<meta name="citation_reference" content="citation_title=Physically based modeling of many-year dynamics of daily streamflow and snow water equivalent in the lena r. basin;,citation_author=EM Gusev;,citation_author=ON Nasonova;,citation_author=L Ya Dzhogan;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_volume=43;,citation_journal_title=Water Resources;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Geomorphic characteristics influencing post-fire river response in mountain streams.;,citation_abstract=As wildfires increase in frequency and severity, there is a growing interest in understanding river response to the wildfire disturbance cascade. Numerous headwater mountain catchments within the Cache la Poudre (Poudre) River basin in the Colorado Front Range, USA burned severely and extensively during the 2020 Cameron Peak fire. Debris flows and flash floods occurred in many of these catchments triggered by convective storms after the fire. The downstream effects of the floods and sediment varied along a continuum from attenuated and largely contained within the catchment, to releasing substantial volumes of water and sediment to the Poudre River. We conceptualize these catchments as exhibiting decreasing absorbance of post-fire disturbance along the continuum described above based on the geomorphic evidence of relative sediment export. We conceptualize characteristics on different spatial scales as driving or resisting response to disturbance and therefore impacting the absorbing c;,citation_author=Shayla Triantafillou;,citation_author=Ellen Wohl;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://ezproxy2.library.colostate.edu/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;amp;amp;amp;AuthType=cookie,ip,url,cpid&amp;amp;custid=s4640792&amp;amp;db=aph&amp;amp;AN=180492756&amp;amp;site=ehost-live;,citation_issn=0169555X;,citation_volume=466;,citation_journal_title=Geomorphology;">
<meta name="citation_reference" content="citation_title=Snowpacks decrease and streamflows shift across the eastern US as winters warm.;,citation_author=Chanse M. Ford;,citation_author=Anthony D. Kendall;,citation_author=David W. Hyndman;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://ezproxy2.library.colostate.edu/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;amp;amp;amp;AuthType=cookie,ip,url,cpid&amp;amp;custid=s4640792&amp;amp;db=asn&amp;amp;AN=152080320&amp;amp;site=ehost-live;,citation_issn=00489697;,citation_volume=793;,citation_journal_title=Science of the Total Environment;">
<meta name="citation_reference" content="citation_title=Hydrological response of an alpine catchment to rainfall and snowmelt events;,citation_abstract=Summary Alpine catchments are important sources of fresh water but compared to lower altitude catchments our understanding of the hydrological functioning of these catchments during rainfall and snowmelt events is still limited. The objectives of this study were i) to identify the dominant runoff generation mechanisms in the 0.14-km2 Bridge Creek Catchment in the Italian Dolomites during nine rainfall–runoff events and six snowmelt–runoff events in spring, summer and autumn of 2010–2012; and ii) to assess the effect of the selection of the pre-event water sample on the isotope hydrograph separation results. The isotopic composition of the pre-event water was determined by either a stream water sample taken prior to the event or the average of 19 stream water samples taken during baseflow conditions. The hydrograph separation results for the two methods were very similar for the rainfall events but differed for the snowmelt events. Average event water contributions ranged between 4;,citation_author=D. Penna;,citation_author=H. J. Meerveld;,citation_author=G. Zuecco;,citation_author=G. Dalla Fontana;,citation_author=M. Borga;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0022169416301457;,citation_doi=https://doi.org/10.1016/j.jhydrol.2016.03.040;,citation_issn=0022-1694;,citation_volume=537;,citation_journal_title=Journal of Hydrology;">
<meta name="citation_reference" content="citation_title=The value of accurate high-resolution and spatially continuous snow information to streamflow forecasts.;,citation_abstract=Previous studies have shown limited success in improving streamflow forecasting for snow-dominated watersheds using physically based models, primarily due to the lack of reliable snow water equivalent (SWE) information. Here we use a hindcasting approach to evaluate the potential benefit that a high-resolution, spatiotemporally continuous, and accurate SWE reanalysis product would have on the seasonal streamflow forecast in the snow-dominated Sierra Nevada mountains of California if such an SWE product were available in real time. We tested the efficacy of a physically based ensemble streamflow prediction (ESP) framework when initialized with the reanalysis SWE. We reinitialized the SWE over the Sierra Nevada at the time when the Sierra Nevada had domain-wide annual maximum SWE for each year in 1985–2015, and on 1 February of the driest years within the same period. The early season forecasts on 1 February provide valuable lead time for mitigating the impact of drought. In both experi;,citation_author=Dongyue Li;,citation_author=Dennis P. Lettenmaier;,citation_author=Steven A. Margulis;,citation_author=Konstantinos Andreadis;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_fulltext_html_url=https://ezproxy2.library.colostate.edu/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;amp;amp;amp;AuthType=cookie,ip,url,cpid&amp;amp;custid=s4640792&amp;amp;db=asn&amp;amp;AN=136116302&amp;amp;site=ehost-live;,citation_issue=4;,citation_issn=1525755X;,citation_volume=20;,citation_journal_title=Journal of Hydrometeorology;">
<meta name="citation_reference" content="citation_title=USGS 06752000 CACHE LA POUDRE RIV AT MO OF CN, NR FT COLLINS, CO;,citation_author=U.S. Geological Survey;,citation_publisher=https://waterdata.usgs.gov/co/nwis/inventory/?site_no=06752000;">
<meta name="citation_reference" content="citation_title=SNOTEL site: 551 (Berthoud Summit);,citation_author=U.S. Department of Agriculture, Natural Resources Conservation Service;,citation_publisher=https://wcc.sc.egov.usda.gov/nwcc/site?sitenum=551;">
<meta name="citation_reference" content="citation_title=An overview of snow water equivalent: Methods, challenges, and future outlook;,citation_author=Mercedeh Taheri;,citation_author=Abdolmajid Mohammadian;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_issue=18;,citation_volume=14;,citation_journal_title=Sustainability;,citation_publisher=MDPI;">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Snowmelt and Streamflow: The Role of Snow Water Equivalent in Shaping Discharge Patterns in the Cache la Poudre River</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliation</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Maya McCain </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Colorado State University
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Emily Mitchell </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Colorado State University
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Ally Lewis </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Colorado State University
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      <div class="quarto-alternate-formats"><div class="quarto-title-meta-heading">Other Formats</div><div class="quarto-title-meta-contents"><p><a href="index.docx"><i class="bi bi-file-word"></i>MS Word</a></p></div><div class="quarto-title-meta-contents"><p><a href="index-meca.zip" data-meca-link="true"><i class="bi bi-archive"></i>MECA Bundle</a></p></div></div></div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract" class="nav-link active" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  <li><a href="#discussion-conclusions" id="toc-discussion-conclusions" class="nav-link" data-scroll-target="#discussion-conclusions">Discussion &amp; Conclusions</a></li>
  </ul>
<div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="index-preview.html"><i class="bi bi-journal-code"></i>Article Notebook</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">Abstract</h2>
<p>Snow water equivalent (SWE) is an important driver of streamflow in snow-dominant hydrologic systems where the timing and magnitude of snowmelt influences downstream water availability. Understanding the relationship between SWE and streamflow is essential for accurately predicting water availability and effectively managing water resources. To investigate this relationship, we analyzed data from the Joe Wright SNOTEL station and the USGS stream gauge at the mouth of the Cache la Poudre River canyon from 2013 to 2023. We utilized time series analysis, linear regression, and cross correlation techniques along with other statistical tests and data visualizations to assess the trends and relationship between SWE and discharge. Our results show a clear seasonal pattern, with annual peak streamflow occurring approximately 1-2 months after peak SWE. We found a significant predictive relationship between SWE and discharge with a one unit increase in SWE corresponding to a 0.1485 increase in the log of discharge (Figure 7). The linear regression also revealed that approximately 40% of the variation in streamflow can be predicted by SWE (R² = 0.399, adjusted R² = 0.399) (Figure 7). These findings highlight the value of SWE as a predictor of streamflow and suggest that continued research of snowpack dynamics is necessary for water planning. Improved understanding of the relationship between SWE and discharge supports adaptive watershed management, which is even more critical as snowmelt-dependent watersheds face increasing climate variability.</p>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Water is an integral part of ecosystems and human-related necessities. Understanding the relationship between snow water equivalent (SWE) and streamflow can highlight important indicators for water management, drought, flood risk, and ecosystem health, especially in regions where snowmelt is a large factor in the annual hydrological cycle. By investigating this relationship, researchers can begin to further understand indicators for water management, predicting drought, flood mitigation, and sustainability in areas where snow is one of the largest contributors to the water cycle.</p>
<p>SWE refers to the amount of water that is stored in the snowpack each season. The runoff from local snowpack every spring is a significant source of water that replenishes nearby streams and aquifers. This water cycle can be affected by a number of environmental factors, such as solar radiation, temperature, and anthropogenic sources <span class="citation" data-cites="taheri2022overview">(<a href="#ref-taheri2022overview" role="doc-biblioref">Taheri &amp; Mohammadian, 2022</a>)</span>. The effects from these factors can range from changes in streamflow patterns to changes in local ecological health and water availability.</p>
<p>One of the primary metrics for monitoring and interpreting streamflow is discharge data, which quantifies the volume of water moving through a river channel over time. This data can be utilized to make decisions about water use for agriculture, industry, hydroelectric power, and domestic use <span class="citation" data-cites="maity2011">(<a href="#ref-maity2011" role="doc-biblioref">Maity &amp; Kashid, 2011</a>)</span>. Increasing pressures on freshwater resources mean that water must be treated as an invaluable resource that requires careful management in order to prevent overconsumption, depletion, and ecological damage.</p>
<p>Climate change is undoubtedly one of the most pressing challenges humans face, as well as one that is tied to the relationship between snowpack and streamflow. Changing global temperatures significantly impacting the hydrologic cycle is a growing concern that is highly linked to water resource use <span class="citation" data-cites="hammond2018">(<a href="#ref-hammond2018" role="doc-biblioref">Hammond, Saavedra, &amp; Kampf, 2018</a>)</span>. Rising temperatures and shifting precipitation patterns also influence snow accumulation and subsequently snowmelt and streamflow <span class="citation" data-cites="hammond2018">(<a href="#ref-hammond2018" role="doc-biblioref">Hammond et al., 2018</a>)</span>. Understanding these interconnected processes is essential for ensuring sustainable water resource management as humans continue to adapt to a changing world.</p>
<p>Drought, an increasingly frequent occurrence due to climate change, has a particularly negative impact on water supply and discharge. This is important to take into consideration when predicting streamflow, especially where water availability is heavily reliant on snowmelt <span class="citation" data-cites="modi2022">(<a href="#ref-modi2022" role="doc-biblioref">Modi, Small, Kasprzyk, &amp; Livneh, 2022</a>)</span>. As drought conditions become more problematic and streamflow becomes harder to predict, the impact to water users and ecological stability grows as well. Despite this, the relationship between snow water equivalent and discharge may be used to create models for streamflow predictability <span class="citation" data-cites="modi2022">(<a href="#ref-modi2022" role="doc-biblioref">Modi et al., 2022</a>)</span>. An important factor to consider when building these models and diving into streamflow predictability is the influence on time lag between precipitation and discharge changes <span class="citation" data-cites="maity2011">(<a href="#ref-maity2011" role="doc-biblioref">Maity &amp; Kashid, 2011</a>)</span>. This lag can also be influenced by basin topography and environmental factors that should be taken into account.</p>
<p>In the western United States, many watersheds are snow-dominated, meaning that snowpack serves as a primary source of water for rivers, streams, and aquifers during warmer months. Snow-dominated basins, including those in the Rocky Mountains of Colorado, have a predictive relationship between snow water equivalent (SWE) and water supply and availability <span class="citation" data-cites="modi2022">(<a href="#ref-modi2022" role="doc-biblioref">Modi et al., 2022</a>)</span>. This relationship between snowpack and discharge is especially relevant in the Cache la Poudre River because streamflow is influenced by the timing and quantity of snowmelt. Studying this relationship will allow for better understanding of the drivers of discharge rates and variability and help develop more accurate tools for predicting water availability. It is important to be prepared for variable water levels that may have implications on the environment and anthropogenic uses.</p>
<p>In order to explore the relationship between snow water equivalent and discharge, we utilized discharge and snow water equivalent data. It is essential to utilize continuous and high quality SWE and streamflow data, as they are the most reliable for predictions and analysis of patterns <span class="citation" data-cites="13611630220190401">(<a href="#ref-13611630220190401" role="doc-biblioref">Li, Lettenmaier, Margulis, &amp; Andreadis, 2019</a>)</span>. By synthesizing and analyzing these datasets, we aim to investigate how changes in snowpack levels impact river discharge. We hypothesize that as snow water equivalent at the SNOTEL station decreases, discharge in the Cache la Poudre River will increase. Additionally, we predict that there will be seasonal patterns that correlate between SWE and streamflow.</p>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<p>We utilized daily average snow water equivalent (SWE) data and daily average discharge data recorded in the Cache la Poudre River. The SWE data, obtained from the USDA Natural Resources Conservation Service, consists of observations from the Joe Wright SNOTEL Station (Station 551) <span class="citation" data-cites="usda_snotel_551">(<a href="#ref-usda_snotel_551" role="doc-biblioref">U.S. Department of Agriculture, Natural Resources Conservation Service, n.d.</a>)</span>. The dates of collection that we examined span from the years 2013 to 2023. We obtained discharge data from the Colorado Division of Water Resources website from a DWR/USGS gauge site titled “Cache La Poudre at Canyon Mouth Near Fort Collins” <span class="citation" data-cites="usgs_06752000">(<a href="#ref-usgs_06752000" role="doc-biblioref">U.S. Geological Survey, n.d.</a>)</span>. This gauge is located on the left bank of the river approximately 9 miles northwest of Fort Collins. The dates of collection that we will be looking at align with the SWE data (2013 - 2023).</p>
<p><strong>Figure 1. SWE and Discharge Data Visualization</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-1" href="index-preview.html">Source: Article Notebook</a></div>
<p><strong>Figure 2. Discharge Visualization for Linear Regression Assumptions</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>To clean our data, we dropped all of the NA values. To merge the datasets and continue with our methods, we adjusted the format and groupings of the dates to further explore the distribution of variables. We had difficulty with aligning the dates properly, but were able to organize them effectively through the use of the package Tidyr in RStudio. A histogram of the discharge data revealed that it was heavily right skewed (Figure 2). To satisfy the assumptions of our statistical tests, we then log transformed the discharge values.</p>
<p>We decided to focus our project on a local scope. The Cache la Poudre River runs through Fort Collins that serves as an important drinking water source. We narrowed our analysis from a 24 year period to a 10 year period, ranging from 2013 to 2023, which still allowed us to examine long-term trends that may appear. To analyze our data, we completed a number of statistical and visual analyses of our two hydrologic datasets. This included creating both scatter plots and time series visualizations. We performed a linear regression to assess the relationship between SWE and discharge. We also conducted a paired t-test to identify the strength of the relationship between snow water equivalent and stream discharge. To visualize this relationship between our variables, we utilized a cross-correlation to determine if there are noticeable seasonal lags from the time of snow water equivalent collection and stream discharge. The cross-correlation compares each variable under different time shifts, and determines which time shift created the highest level of correlation. This reveals the lag period between the two values.</p>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>We visualized streamflow of the Cache la Poudre River and snow water equivalent from the Joe Wright SNOTEL Station using time series analysis. Each year, there are peaks and declines in both discharge and snow water equivalent (Figure 3). These peaks are due to seasonal changes that induce accumulation and melting. When looking at SWE and streamflow over time, there are clear similarities in patterns of snow accumulation and melting, as well as discharge volume (Figure 3). Years of higher SWE correlate with years of higher streamflow, a pattern that is especially apparent in 2013 and 2014 (Figure 3). Additionally, there is clear interannual variability of both streamflow and SWE, suggesting differences in precipitation each year (Figure 3).</p>
<p><strong>Figure 3. Streamflow in the Cache la Poudre River and Joe Wright SNOTEL Station SWE over a 20 year period.</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Monthly patterns emerge in both SWE and streamflow, indicating seasonal patterns as well as the relationship between SWE and discharge levels. Late Spring and early Summer months depict higher discharge patterns at the mouth of the Cache la Poudre River (Figure 6). May through July depict higher discharge levels as opposed to the later Summer, Fall, and early Spring months. SWE is the highest in the late Winter months, most likely due to snowfall and snow accumulation. The monthly patterns of SWE and streamflow in June indicate an apparent relationship between the variables (Figure 6). SWE has a rapid decrease in June while streamflow has a drastic increase (Figure 6). This leads us to believe SWE directly affects streamflow.</p>
<p>Discharge levels are relatively low October through March, when the water is stored as snow, then increases as temperatures warm and the snow starts melting (Figure 6). The melted snow enters the Cache la Poudre watershed, making its way into the Poudre River and increasing streamflow. In the late summer months, specifically July through September, streamflow begins to decrease, as there is little to no snow as a water source (Figure 6). Breaking down the average monthly streamflow and SWE trends by year revealed further insights into annual variation (Figure 5). This allows individual years with anomalies or specific events of interest such as fire or flood to be examined more closely. For example, Figure 5 indicates differences in SWE and discharge trends in 2021 when there was severe flooding following the Cameron Peak Fire in 2020.</p>
<p><strong>Figure 4. Average Monthly Streamflow and SWE.</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p><strong>Figure 5. Average Monthly Swe and Streamflow Trends by Year for the 10 year study period.</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p><strong>Figure 6. Monthly patterns of streamflow in the Cache la Poudre River and SWE at the Joe Wright SNOTEL Station over a 10 year period.</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>We also conducted a simple linear regression analysis to determine the relationship between SWE and the logarithm of discharge (Q_log) within our dataset (Figure 7). The model revealed a statistically significant positive relationship between SWE and Q_log ((β = 0.149, SE = 0.002, t = 71.95, p &lt; 2 × 10-16). This indicates that increases in SWE are associated with increases in streamflow. When SWE is zero, the expected discharge value is 3.02. The residual standard error was 1.67, based on 7,798 degrees of freedom. Furthermore, the model accounted for approximately 40% of the variance in Q_log, suggesting a moderate fit (R² = 0.399, adjusted R² = 0.399). Although an R-squared value of 0.399 indicates that a substantial portion of the variance in streamflow remains unexplained, we consider it to be satisfactory in this context. Streamflow is influenced by a wide range of environmental factors not included in this analysis, so having a single predictor (SWE) explain nearly 40% of the variance is meaningful in a variety of ways. While including additional predictor variables such as precipitation, soil type, slope, and land cover may improve overall model performance, this result highlights the role SWE plays in driving discharge variability. Additionally, it serves as a solid foundation for future research that incorporates additional dynamics or model structures.</p>
<p><strong>Figure 7. Results of Linear Regression</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_Q ~ swe, data = swe_disch)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.4056 -0.6343  0.2720  1.6738  4.7426 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.459642   0.052943  84.235  &lt; 2e-16 ***
swe         -0.022536   0.004574  -4.927 8.71e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.414 on 3909 degrees of freedom
Multiple R-squared:  0.006171,  Adjusted R-squared:  0.005917 
F-statistic: 24.27 on 1 and 3909 DF,  p-value: 8.713e-07</code></pre>
</div>
</div>
<p>A Welch Two-Sample t-test was also conducted to compare the means of stream discharge prior to the Cameron Peak fire in August of 2020. The two sample periods were July 2020 for pre-fire means and from July 2021 for post-fire means. The purpose of this test is to determine any changes that may have occurred in discharge intensity caused by the Cameron Peak fire. The results of this two-sample t-test revealed a statistically significant difference in monthly means, with the mean discharge for July 2021 being substantially higher at 465.90, in comparison to the mean discharge from July 2020 which was 353.33. Specifically, the analysis produced a p-value of 0.03, further indicating the statistically significant difference between the two sets of data. The 95% confidence interval produced ranges from -215.43 to -9.7, suggesting that the true difference between mean discharge is likely to fall within this range of values. These findings further imply the lasting effects of the Cameron Peak fire the year prior, and the severity in which these effects can occur.</p>
<p><strong>Figure 8. T-test Before and After the Cameron Peak Wildfire of 2020.</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  pre_fire_data$Q and post_fire_data$Q
t = -2.1925, df = 55.64, p-value = 0.03255
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -215.426536   -9.699901
sample estimates:
mean of x mean of y 
 353.3333  465.8966 </code></pre>
</div>
</div>
<p>The purpose of the cross correlation analysis was to determine the length of lag time, if any, between SWE and river discharge values. By testing the strength of the correlation between the SWE values and discharge levels, the length of lag time can also be determined. As shown in Figure 9, there is a distinctly direct relationship between the two values, with a lag time of 0. In other words, the effect that SWE has on river discharge is not delayed in this dataset, and the increase in recorded discharge occurs in conjunction with SWE decrease. However, through additional research on the relationship between these two values and the other statistical tests mentioned, lag time for this area is approximately 2 months in length. This indicates that peak levels of discharge occur roughly 2 months after peak levels of SWE. Lag time can vary between datasets and collection locations, and this analysis highlights an important component in determining timing of drought and flood conditions, and how it may be predicted and mitigated.</p>
<p><strong>Figure 9. Cross Correlation Visualization between SWE and Discharge</strong></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="discussion-conclusions" class="level2">
<h2 class="anchored" data-anchor-id="discussion-conclusions">Discussion &amp; Conclusions</h2>
<p>Streamflow patterns based on snow water equivalent provide information valuable for water management, flood prediction, and drought conditions. Years with lower SWE and streamflow are explained by decreased precipitation levels, causing reduced snowpack and early melting <span class="citation" data-cites="15208032020211101">(<a href="#ref-15208032020211101" role="doc-biblioref">Ford, Kendall, &amp; Hyndman, 2021</a>)</span>. Low seasonal precipitation periods like this may lead to increased drought as they occur more frequently. It is important to understand snowpack and snow water equivalent because they are indicators of when and how much water will enter the river in the following months. This relationship between SWE and discharge is directly related, enabling SWE to be a predictor of streamflow <span class="citation" data-cites="modi2022">(<a href="#ref-modi2022" role="doc-biblioref">Modi et al., 2022</a>)</span>. When creating models for water supply predictions, years where drought occurred may bring errors while training the models to predict streamflow <span class="citation" data-cites="modi2022">(<a href="#ref-modi2022" role="doc-biblioref">Modi et al., 2022</a>)</span>. Fluctuations in precipitation are becoming an increasingly apparent problem, especially in snow-reliant watersheds.</p>
<p>When there are higher levels of snow water equivalent, there is more opportunity for melting and increased discharge when temperature fluctuations occur. Drought has caused evident declines in snowpack and subsequently, streamflow <span class="citation" data-cites="modi2022">(<a href="#ref-modi2022" role="doc-biblioref">Modi et al., 2022</a>)</span>. In turn, there has been increased variability in snowpack and streamflow interannually, creating difficulties predicting water supply <span class="citation" data-cites="modi2022">(<a href="#ref-modi2022" role="doc-biblioref">Modi et al., 2022</a>)</span>. Drought years are hard to predict because historical snowpack and streamflow data do not consistently reflect these changes in climate <span class="citation" data-cites="modi2022">(<a href="#ref-modi2022" role="doc-biblioref">Modi et al., 2022</a>)</span>. Seasonal changes in snow precipitation can show patterns, however differences in year to year patterns are harder to understand given the level of fluctuation in the data (Figure 5). Understanding the lag patterns between snow water equivalent and stream discharge in different areas are also integral to predicting the timing of flooding, in conjunction with weather patterns and predictions of increased rainfall (Figure 9). This can allow communities to prepare for less-than ideal conditions and mitigate damage and loss.</p>
<p>Warmer winter temperatures have a significant impact on hydrologic dynamics, especially in snow-dominated regions. Warmer winters are becoming increasingly common, which directly impacts precipitation, streamflow, and peak flows <span class="citation" data-cites="15208032020211101">(<a href="#ref-15208032020211101" role="doc-biblioref">Ford et al., 2021</a>)</span>. As this climate shift occurs, peak flows occur earlier in the season due to reduced snow depth <span class="citation" data-cites="15208032020211101">(<a href="#ref-15208032020211101" role="doc-biblioref">Ford et al., 2021</a>)</span>. The relationship between SWE and discharge indicates that the amount of snowpack directly correlates to flow levels (Figure 4). If there is less SWE in the Winter, peak streamflow will occur earlier in the year than normal. There are various other characteristics of a watershed that affect the process of precipitation to discharge levels, including saturated riparian zones, slope, and groundwater interactions <span class="citation" data-cites="PENNA2016382">(<a href="#ref-PENNA2016382" role="doc-biblioref">Penna, van Meerveld, Zuecco, Dalla Fontana, &amp; Borga, 2016</a>)</span>. The relationship between SWE and streamflow is complex, as there are many factors at play that may contribute to higher or lower discharge levels.</p>
<p>Two major floods in the Cache la Poudre River were mainly caused by increased rainfall events following severe wildfires. High severity wildfires increase erosion and decrease infiltration rates <span class="citation" data-cites="18049275620241201">(<a href="#ref-18049275620241201" role="doc-biblioref">Triantafillou &amp; Wohl, 2024</a>)</span>. This causes an abnormally high amount of water to enter a river instead of permeating the soil and entering groundwater, which creates high flows and even flooding in some areas. The High Park Fire in 2012 preceded a severe flood in the Cache la Poudre River in 2013. In a similar instance, the Cameron Peak Fire in 2020 contributed to a major flood in the Poudre River in 2021 (Figure 8). Given that drought conditions already decrease soil infiltration, the combination of drought conditions and increased wildfires could have detrimental effects on potential flood areas and snow-reliant watersheds. Having the knowledge of SWE and its predictive qualities of streamflow can assist in predicting floods following wildfires, high levels of precipitation during the winter, and increased discharge in the spring (Figure 5). This ability to predict natural events allows time for mitigation and preparation of the community.</p>
<p>Ultimately, this study aimed to examine the relationship between snow water equivalent (SWE) and discharge to better understand how snowpack dynamics contribute to streamflow. While we did find a significant relationship between SWE and discharge, several limitations should be considered. Our linear regression model only included one predictor and thus did not consider how the relationship between SWE and discharge is influenced by additional factors such as temperature, soil moisture, evapotranspiration, or spatial heterogeneity, which could have further refined the predictions. Additionally, our analysis only included data from one SNOTEL site and one USGS discharge gauge. Future work may build on the findings of this study by increasing the sample size in order to better understand regional variations. It may also be beneficial to utilize nonlinear models or machine learning techniques to capture more complex dynamics. Overall, the results of this study demonstrate the importance of SWE as a reliable predictor of streamflow, providing a valuable tool for evaluating and anticipating water availability and guiding water management.</p>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-15208032020211101" class="csl-entry" role="listitem">
Ford, C. M., Kendall, A. D., &amp; Hyndman, D. W. (2021). Snowpacks decrease and streamflows shift across the eastern US as winters warm. <em>Science of the Total Environment</em>, <em>793</em>, N.PAG. Retrieved from <a href="https://ezproxy2.library.colostate.edu/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;amp;AuthType=cookie,ip,url,cpid&amp;amp;custid=s4640792&amp;amp;db=asn&amp;amp;AN=152080320&amp;amp;site=ehost-live">https://ezproxy2.library.colostate.edu/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;amp;AuthType=cookie,ip,url,cpid&amp;amp;custid=s4640792&amp;amp;db=asn&amp;amp;AN=152080320&amp;amp;site=ehost-live</a>
</div>
<div id="ref-hammond2018" class="csl-entry" role="listitem">
Hammond, J. C., Saavedra, F. A., &amp; Kampf, S. K. (2018). How does snow persistence relate to annual streamflow in mountain watersheds of the western US with wet maritime and dry continental climates? <em>Water Resources Research</em>, <em>54</em>(4), 2605–2623.
</div>
<div id="ref-13611630220190401" class="csl-entry" role="listitem">
Li, D., Lettenmaier, D. P., Margulis, S. A., &amp; Andreadis, K. (2019). The value of accurate high-resolution and spatially continuous snow information to streamflow forecasts. <em>Journal of Hydrometeorology</em>, <em>20</em>(4), 731–749. Retrieved from <a href="https://ezproxy2.library.colostate.edu/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;amp;AuthType=cookie,ip,url,cpid&amp;amp;custid=s4640792&amp;amp;db=asn&amp;amp;AN=136116302&amp;amp;site=ehost-live">https://ezproxy2.library.colostate.edu/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;amp;AuthType=cookie,ip,url,cpid&amp;amp;custid=s4640792&amp;amp;db=asn&amp;amp;AN=136116302&amp;amp;site=ehost-live</a>
</div>
<div id="ref-maity2011" class="csl-entry" role="listitem">
Maity, R., &amp; Kashid, S. (2011). Importance analysis of local and global climate inputs for basin-scale streamflow prediction. <em>Water Resources Research</em>, <em>47</em>(11).
</div>
<div id="ref-modi2022" class="csl-entry" role="listitem">
Modi, P. A., Small, E. E., Kasprzyk, J., &amp; Livneh, B. (2022). Investigating the role of snow water equivalent on streamflow predictability during drought. <em>Journal of Hydrometeorology</em>, <em>23</em>(10), 1607–1625.
</div>
<div id="ref-PENNA2016382" class="csl-entry" role="listitem">
Penna, D., van Meerveld, H. J., Zuecco, G., Dalla Fontana, G., &amp; Borga, M. (2016). Hydrological response of an alpine catchment to rainfall and snowmelt events. <em>Journal of Hydrology</em>, <em>537</em>, 382–397. https://doi.org/<a href="https://doi.org/10.1016/j.jhydrol.2016.03.040">https://doi.org/10.1016/j.jhydrol.2016.03.040</a>
</div>
<div id="ref-taheri2022overview" class="csl-entry" role="listitem">
Taheri, M., &amp; Mohammadian, A. (2022). An overview of snow water equivalent: Methods, challenges, and future outlook. <em>Sustainability</em>, <em>14</em>(18), 11395.
</div>
<div id="ref-18049275620241201" class="csl-entry" role="listitem">
Triantafillou, S., &amp; Wohl, E. (2024). Geomorphic characteristics influencing post-fire river response in mountain streams. <em>Geomorphology</em>, <em>466</em>, N.PAG. Retrieved from <a href="https://ezproxy2.library.colostate.edu/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;amp;AuthType=cookie,ip,url,cpid&amp;amp;custid=s4640792&amp;amp;db=aph&amp;amp;AN=180492756&amp;amp;site=ehost-live">https://ezproxy2.library.colostate.edu/login?url=https://search.ebscohost.com/login.aspx?direct=true&amp;amp;AuthType=cookie,ip,url,cpid&amp;amp;custid=s4640792&amp;amp;db=aph&amp;amp;AN=180492756&amp;amp;site=ehost-live</a>
</div>
<div id="ref-usda_snotel_551" class="csl-entry" role="listitem">
U.S. Department of Agriculture, Natural Resources Conservation Service. (n.d.). <em><span class="nocase">SNOTEL site: 551 (Berthoud Summit)</span></em>. <a href="https://wcc.sc.egov.usda.gov/nwcc/site?sitenum=551" class="uri">https://wcc.sc.egov.usda.gov/nwcc/site?sitenum=551</a>.
</div>
<div id="ref-usgs_06752000" class="csl-entry" role="listitem">
U.S. Geological Survey. (n.d.). <em><span>USGS 06752000 CACHE LA POUDRE RIV AT MO OF CN, NR FT COLLINS, CO</span></em>. <a href="https://waterdata.usgs.gov/co/nwis/inventory/?site_no=06752000" class="uri">https://waterdata.usgs.gov/co/nwis/inventory/?site_no=06752000</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","descPosition":"bottom","loop":false,"openEffect":"zoom","closeEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>